parameters:
  - name: version
    type: string
    default: 0.0.1


resources:
  repositories:
  - repository: releaseEngine
    type: github
    endpoint: devopsnights
    name: devopsnights/AzureDevOpsReleaseEngine
    ref: refs/heads/feature/psmodules
    
trigger:
  branches:
    include:
    - main
    - feature/*
  paths:
    include:
      - src/development/powershell/psModules/*
pool:
  vmImage: 'windows-latest'
  # name: default

extends: 
  template: /src/main.yml@releaseEngine
  parameters:
    settings:
      build:
        enabled: true
      deploy:
        enabled: false
        variablesDirectory: /src/development/dotnetCore/examples/variables
        infrastructure:
          enabled: true
        application:
          enabled: true
      azure:
        subscription:
          serviceConnection: $(serviceConnection)
          subscriptionId: $(subscriptionId)
        resourceGroup:
          name: $(resourceGroupName)
          location: $(location)
          new: true
      environments:
        - dev
        - uat
        - prd
    resources:
      - name: psModules
        type: psModules
        runName: psModules
        enabled: true
        deploy:
          type: azureArtifacts
          version: ${{ parameters.version }}
          application:
            enabled: true

